USE [WideWorldImporters]
GO
CREATE ASSEMBLY [SendSBMsg]
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300CA9E9DA20000000000000000E00022200B013000002000000006000000000000923F00000020000000400000000000100020000000020000040000000000000006000000000000000080000000020000110F01000300608500001000001000000000100000100000000000001000000000000000000000003E3F00004F0000000040000078030000000000000000000000280000C0050000006000000C0000009C3E0000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000981F0000002000000020000000020000000000000000000000000000200000602E7273726300000078030000004000000004000000220000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000002600000000000000000000000000004000004200000000000000000000000000000000723F0000000000004800000002000500282600007418000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300500290300000100001100280F00000A0A72010000700B72010000700C281000000A1306281100000A13077203000070731200000A1308000011086F1300000A0072330000701108731400000A251304130A001104176F1500000A251305130B0011056F1600000A130C110C2C14001105166F1700000A0B1105176F1700000A0C0011056F1800000A0000DE0D110B2C08110B6F1900000A00DC00DE0D110A2C08110A6F1900000A00DC7272020070087296020070281A00000A0D11066F1B00000A19FE01130D110D2C1D0072AA02007013090972D6020070077214030070281C00000A0D002B1B0072320300701309097260030070077214030070281C00000A0D0011091108731400000A251304130E001104176F1500000A251305130F00388E0000000009729E030070281D00000A0D1613102B5E00110511106F1E00000A13111E8D26000001251609A2251772AA030070A225181111A2251972AE030070A2251A110511106F1F00000A6F2000000AA2251B72B2030070A2251C1111A2251D72AE030070A2282100000A0D00111017581310111011056F2200000AFE04131211122D910972B8030070281D00000A0D0011056F1600000A131311133A62FFFFFF00DE0D110F2C08110F6F1900000A00DC11056F1800000A0000DE0D110E2C08110E6F1900000A00DC0972C6030070281D00000A0D00DE21131400110772EA03007011146F2300000A281D00000A6F2400000A00DD1701000011086F2500000A0011077202040070280F00000A1315121506282600000A13161216282700000A13171217282800000A281D00000A6F2400000A0000DE0D11082C0811086F1900000A00DC000028020000061318732900000A131911196F2A00000A1F1811186F2B00000A0011196F2A00000A1F0C722A0400706F2B00000A00282C00000A096F2D00000A131A111972860400707200050070111A6F2E00000A261119121B2803000006131C111C202B010000FE02131D111D2C1B1107121C282F00000A720A050070111B281A00000A6F2400000A0000DE3E131E0011077210050070111E2804000006281D00000A6F2400000A0000DE1F131F00110772EA030070111F6F2300000A281D00000A6F2400000A0000DE002A00000041C4000002000000560000002D000000830000000D0000000000000002000000480000004B000000930000000D000000000000000200000015010000A7000000BC0100000D000000000000000200000007010000CD000000D40100000D00000000000000000000002E000000C2010000F00100002100000017000001020000002D000000220200004F0200000D00000000000000000000005D0200008D000000EA0200001F0000001A000001000000005D0200008D000000090300001F0000001700000113300800CA0000000200001100120020B2070000171716161616283000000A280F00000A13061206283100000A06283200000A0B1201283300000A283400000A20B0040000580C7230050070283500000A72700500701202283600000A281A00000A0D282C00000A72740500706F2D00000A733700000A13041104282C00000A096F2D00000A6F3800000A283900000A1305283A00000A72CE0500701A8D1000000125167230050070283500000AA225171105283500000AA22518088C2F000001A225197236060070A2283B00000A13072B0011072A000013300300540000000300001100026F3C00000A726A0600701F246F3D00000A0A0614283E00000A0B072C2A0006026F3F00000A751D0000010C0814FE030D092C130003086F4000000A51086F4100000A13042B09000314511613042B0011042A1B3004007C0000000400001100026F2300000A0A00026F4200000A741D0000010B076F4300000A0C734400000A0D08096F4500000A00096F4600000A1304282C00000A11046F4700000A7286060070076F4100000A13051205FE16200000016F2000000A72AA060070281C00000A0A00DE0E13060011066F2300000A0A00DE000613072B0011072A01100000000008005E66000E170000012202284800000A002A00000042534A4201000100000000000C00000076342E302E33303331390000000005006C000000A0040000237E00000C050000B006000023537472696E677300000000BC0B0000B0060000235553006C1200001000000023475549440000007C120000F805000023426C6F620000000000000002000001571D02000900000000FA01330016000001000000350000000200000005000000050000000300000048000000050000000E0000000400000001000000030000000000200301000000000006002E02540506009B02540506006201FB040F007405000006008A01BB0306001102BB030600F201BB0306008202BB0306004E02BB0306006702BB030600A101BB030600760135050600540135050600D501BB030600BC01CB020600C80556030600E20056030A006300E4050A009E04E4050A004206CA040A000401CA040A00EE03E40506001504560306006B0356030E00DA05CF050E00FC03CF0506000A006F0606006104BB030E003601CF05060046032B00060040032B000E008C00CF050A002406CA040A00E10347040A00E50435000A00910447040600BF0056030600000356030A009E03CA040600CB0056030E00CD03CF050E007F04CF050600C20218060600040056030600100656030E00A306CF0506000300560306005D036F0606006B0485030600BA04560306000F01560306008C05BB030E003A01CF05000000001E00000000000100010001001000A505000041000100010051802700F90451807300F9045180DA00F90451806406F90451808C06F90450200000000096000703FC0401004C2400000000910074030005010024250000000091009B0004050100842500000000910009040C0503001C26000000008618F5040600040000000100FA050200020035040000010077040900F50401001100F50406001900F5040A002900F50410003100F50410003900F50410004100F50410004900F50410005100F50410005900F50410006100F50415006900F50410007100F50410007900F5041000890054064E0009012F0653000901FB005800B100F50410001101800306009100F5045D009100AC046400210155006C002101FD02700021014601060029014C0106003101B1057500A1009A037C003101B10582003101B1058A002101D20070002101B90290008100F40295003101B1059900210101069F00B900B3009500A9006E0010001101460106008900BF05A300C1001F05AA004101F4029500C900F5040600C9009905AE0049014D03B40059011500BC0059018305C200C9004100C8006101F40295008900F504E0008900EB00EB008900AC03F000C1000E05AA0069010100F9007101A900FE007901F4029500D900F50403018101140309016901E50210018901140116013101B8051C0181000C01300199015A003601E10095063F01E100B9024701E9001F049500E9007D004C01D10029016401A9012E036A01F900F5040600F1005A046F01F9005C0675015901FD027A018100F50406000E00040089010E000800F0010E000C002F020E00100062020E001400BB022E000B0012052E0013001B052E001B003A052E00230043052E002B0052052E00330052052E003B0052052E00430043052E004B0058052E00530052052E005B0052052E00630070052E006B009A052E007300A7051A00D100260152010480000001000000000000000000000000000A03000004000000000000000000000080014C000000000004000000000000000000000080013500000000000400000000000000000000008001560300000000000000546F55496E74333200484D4143534841323536006765745F55544638003C4D6F64756C653E005552490053797374656D2E494F0053797374656D2E446174610055706C6F616444617461006D73636F726C69620052656164004765744669656C640053716C436F6D6D616E640053656E64004E616D657370616365006765745F537461747573436F64650048747470537461747573436F646500476574537461747573436F64650055726C456E636F6465006765745F4D6573736167650049446973706F7361626C6500446F75626C65004765744E616D65004B65794E616D65004461746554696D6500546F556E6976657273616C54696D65006765745F506970650053716C506970650047657454797065006765745F496E76617269616E7443756C74757265006765745F526573706F6E73650048747470576562526573706F6E736500436C6F736500446973706F736500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650047657456616C756500456E636F64696E670053797374656D2E52756E74696D652E56657273696F6E696E6700546F426173653634537472696E6700546F537472696E6700476574537472696E670074726753656E6453424D736700436F6D70757465486173680053656E6453424D73672E646C6C00476574526573706F6E736553747265616D004D656D6F727953747265616D007365745F4974656D0053797374656D0048617368416C676F726974686D0054696D655370616E00476574536173546F6B656E004F70656E0053797374656D2E476C6F62616C697A6174696F6E006765745F54726967676572416374696F6E006F705F5375627472616374696F6E0053797374656D2E5265666C656374696F6E00576562486561646572436F6C6C656374696F6E004462436F6E6E656374696F6E0053716C436F6E6E656374696F6E00576562457863657074696F6E004765744572726F7246726F6D457863657074696F6E006765745F5374617475734465736372697074696F6E007374617475734465736372697074696F6E0053797374656D2E446174612E436F6D6D6F6E00436F7079546F004669656C64496E666F0043756C74757265496E666F0077656245786370004874747052657175657374486561646572004462446174615265616465720053716C4461746152656164657200457865637574655265616465720049466F726D617450726F7669646572004D6963726F736F66742E53716C5365727665722E53657276657200436F6D6D616E644265686176696F72002E63746F720053797374656D2E446961676E6F7374696373006765745F546F74616C5365636F6E6473006765745F546F74616C4D696C6C697365636F6E64730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730047657442797465730042696E64696E67466C616773006765745F4865616465727300434C52547269676765727300436F6E63617400466F726D6174005375627472616374004F626A6563740053797374656D2E4E657400576562436C69656E740053797374656D2E446174612E53716C436C69656E7400636C69656E74006765745F4669656C64436F756E7400436F6E766572740053797374656D2E546578740053716C436F6E74657874006765745F54726967676572436F6E746578740053716C54726967676572436F6E74657874006765745F4E6F7700546F4172726179004163636F756E744B65790053797374656D2E53656375726974792E43727970746F6772617068790074626C7175657279006F705F496E657175616C697479005765625574696C6974790000000001002F63006F006E007400650078007400200063006F006E006E0065006300740069006F006E003D00740072007500650000823D530045004C00450043005400200027005B00270020002B00200073002E005B006E0061006D0065005D0020002B00200027005D002E005B00270020002B0020006F002E005B006E0061006D0065005D0020002B00200027005D0027002C0020005200450050004C004100430045002800400040005300450052005600450052004E0041004D0045002C002000270027002C0020002700250035004300270029002000460052004F004D0020007300790073002E0064006D005F007400720061006E005F006C006F0063006B00730020006C0020006A006F0069006E0020007300790073002E006F0062006A00650063007400730020006F0020006F006E00200028006C002E007200650073006F0075007200630065005F006100730073006F006300690061007400650064005F0065006E0074006900740079005F00690064003D0020006F002E006F0062006A006500630074005F0069006400290020006A006F0069006E0020007300790073002E0073006300680065006D00610073002000730020006F006E00200028006F002E0073006300680065006D0061005F00690064003D00200073002E0073006300680065006D0061005F00690064002900200057004800450052004500200072006500710075006500730074005F00730065007300730069006F006E005F006900640020003D002000400040007300700069006400200061006E00640020007200650073006F0075007200630065005F00740079007000650020003D00200027004F0042004A00450043005400270001233C006D006500730073006100670065003E003C007300650072007600650072003E0000133C002F007300650072007600650072003E00002B530045004C0045004300540020002A002000460052004F004D002000440045004C004500540045004400003D3C0061006300740069006F006E003E00640065006C006500740065003C002F0061006300740069006F006E003E003C007400610062006C0065003E00001D3C002F007400610062006C0065003E003C0072006F00770073003E00002D530045004C0045004300540020002A002000460052004F004D00200049004E00530045005200540045004400003D3C0061006300740069006F006E003E0069006E0073006500720074003C002F0061006300740069006F006E003E003C007400610062006C0065003E00000B3C0072006F0077003E0000033C0000033E0000053C002F00000D3C002F0072006F0077003E0000233C002F0072006F00770073003E003C002F006D006500730073006100670065003E00001745007800630065007000740069006F006E003A002000002745006C00610070007300650064002000540069006D006500200028006D00730029003A002000005B6100700070006C00690063006100740069006F006E002F00610074006F006D002B0078006D006C003B0074007900700065003D0065006E007400720079003B0063006800610072007300650074003D007500740066002D0038000179680074007400700073003A002F002F006D00760068007300620070006F0063002E0073006500720076006900630065006200750073002E00770069006E0064006F00770073002E006E00650074002F007400610062006C0065006300680061006E00670065002F006D006500730073006100670065007300000950004F005300540000053A002000001F570065006200200045007800630065007000740069006F006E003A002000003F6D00760068007300620070006F0063002E0073006500720076006900630065006200750073002E00770069006E0064006F00770073002E006E006500740000030A00005974004B0075003500740034003900750047004C0074007A0059005700580055006D0062006B006500650053006A007600470046002B006F006C006E006C0046004A0070005100450045007000460062003600490041003D0000675300680061007200650064004100630063006500730073005300690067006E00610074007500720065002000730072003D007B0030007D0026007300690067003D007B0031007D002600730065003D007B0032007D00260073006B006E003D007B0033007D00003352006F006F0074004D0061006E006100670065005300680061007200650064004100630063006500730073004B0065007900001B6D005F0057006500620052006500730070006F006E0073006500002320002800480074007400700053007400610074007500730043006F0064006500200000032900000000CDCD3D959810C940B6E0F4131355BA5500042001010803200001052001011111042001010E042001010233072011450E0E0E1249124D1251125512590E1249124D02021249124D080E0202125D114511610D0E12651D050E08021269125D040000114504000012510400001255062002010E1259072001124D11808D032000020420010E080600030E0E0E0E05200011809D0700040E0E0E0E0E0500020E0E0E0420011C080320000E0500010E1D0E03200008062001116111450320000D0520001280A5072002011180A90E0500001280AD0520011D050E0820031D050E0E1D050E070811451161090E126D0E11450E0A200701080808080808080420001145080002116111451145040001090D0400010E0E052001011D050620011D051D050500010E1D050500001280C50900030E1280C90E1D1C090705127102127502080520001280CD08200212710E1180D107000202127112710420011C1C0520001180811107080E12751279127D1D05118081125D0E0520001280D504200012790520010112790420001D050520010E1D0508B77A5C561934E08966680074007400700073003A002F002F006D00760068007300620070006F0063002E0073006500720076006900630065006200750073002E00770069006E0064006F00770073002E006E00650074002F007400610062006C0065006300680061006E00670065003E6D00760068007300620070006F0063002E0073006500720076006900630065006200750073002E00770069006E0064006F00770073002E006E00650074003252006F006F0074004D0061006E006100670065005300680061007200650064004100630063006500730073004B00650079005874004B0075003500740034003900750047004C0074007A0059005700580055006D0062006B006500650053006A007600470046002B006F006C006E006C0046004A0070005100450045007000460062003600490041003D00823C530045004C00450043005400200027005B00270020002B00200073002E005B006E0061006D0065005D0020002B00200027005D002E005B00270020002B0020006F002E005B006E0061006D0065005D0020002B00200027005D0027002C0020005200450050004C004100430045002800400040005300450052005600450052004E0041004D0045002C002000270027002C0020002700250035004300270029002000460052004F004D0020007300790073002E0064006D005F007400720061006E005F006C006F0063006B00730020006C0020006A006F0069006E0020007300790073002E006F0062006A00650063007400730020006F0020006F006E00200028006C002E007200650073006F0075007200630065005F006100730073006F006300690061007400650064005F0065006E0074006900740079005F00690064003D0020006F002E006F0062006A006500630074005F0069006400290020006A006F0069006E0020007300790073002E0073006300680065006D00610073002000730020006F006E00200028006F002E0073006300680065006D0061005F00690064003D00200073002E0073006300680065006D0061005F00690064002900200057004800450052004500200072006500710075006500730074005F00730065007300730069006F006E005F006900640020003D002000400040007300700069006400200061006E00640020007200650073006F0075007200630065005F00740079007000650020003D00200027004F0042004A00450043005400270002060E030000010300000E070002081265100E0500010E12690801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000000E01000953656E6453424D7367000005010000000017010012436F7079726967687420C2A920203230313900002901002432353663333934392D333037332D343065632D393738302D32623233316637333539306400000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E320000000000000064C0269100000000020000006A000000D43E0000D420000000000000000000000000000010000000000000000000000000000000525344530E39B6D5D040A644B392F707487F0B4501000000433A5C55736572735C6D6976616E6875755C736F757263655C7265706F735C53514C53657276696365427573504F435C53656E6453424D73675C6F626A5C44656275675C53656E6453424D73672E70646200663F00000000000000000000803F0000002000000000000000000000000000000000000000000000723F0000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C00000000000000FF25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001000000018000080000000000000000000000000000001000100000030000080000000000000000000000000000001000000000048000000584000001C03000000000000000000001C0334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B0047C020000010053007400720069006E006700460069006C00650049006E0066006F0000005802000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E007400730000000000000022000100010043006F006D00700061006E0079004E0061006D00650000000000000000003C000A000100460069006C0065004400650073006300720069007000740069006F006E0000000000530065006E006400530042004D00730067000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003C000E00010049006E007400650072006E0061006C004E0061006D0065000000530065006E006400530042004D00730067002E0064006C006C0000004800120001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020002000320030003100390000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000044000E0001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000530065006E006400530042004D00730067002E0064006C006C00000034000A000100500072006F0064007500630074004E0061006D00650000000000530065006E006400530042004D00730067000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E00300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000C000000943F00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C005000000020200308205B106092A864886F70D010702A08205A23082059E020101310B300906052B0E03021A0500304C060A2B060104018237020104A03E303C3017060A2B06010401823702010F3009030100A004A20280003021300906052B0E03021A05000414B1739EEC61EF2F648E050EE5A41CB534329D6190A082036E3082036A30820256A00302010202106DFC260EB312E79845D7F0B3CC0E5088300906052B0E03021D0500303B310B300906035504061302555331163014060355040A130D6D6963726F736F66742E636F6D311430120603550403130B53514C434C5220436572743020170D3139303930343230333432385A180F32303939313233313034303030305A303B310B300906035504061302555331163014060355040A130D6D6963726F736F66742E636F6D311430120603550403130B53514C434C52204365727430820122300D06092A864886F70D01010105000382010F003082010A0282010100BFA0F1A347A83B886B753FA158B65426B1DEECB2C46A9660135BDA45F56F8714800C515BE1609962B57A575E5A4339683CE1665C0E2E3812F6F6958EF96FE97893BD778D4230516005FE682CF5C263E6638A45B21F8F15CC07927B7937796E56591B1D706DF6726D84C646027C5FF28D2B567627A72E0DA6DDF41808D0DF9281E47E9C8AE007CF4DBAD4E349179A1C9FC3E9DD62EC9C448E9CFD3AA9E2DAE3DB9E86A028CFA1C24885C7DFA45FA9C8B35A98ED2EF31A3F5DDD30E03B6E64B1F135BAFA1FAB08199DD5DFAE0F894544100B91AECB117101DAA49E526A309B6915DD822C0285B24F3CFA2BF89088984E21B6674C2B1692B395985C0B51D9EF07D90203010001A370306E306C0603551D01046530638010F4A197D3F4E3ECF1D4E1E0417E935184A13D303B310B300906035504061302555331163014060355040A130D6D6963726F736F66742E636F6D311430120603550403130B53514C434C52204365727482106DFC260EB312E79845D7F0B3CC0E5088300906052B0E03021D05000382010100853E32A6278392ECF28EABD5EB9F2297D3282949818DD9CF4E175AB32D9588B2B144A920D630788E10CBF66DF0A135E43FCD36892F1E779D6D9EEA3CDC417C480D9A95257313C79678235019A419DF1F61E085D5B23CADDEDA108B16DF4C6C31658D56816A85424D90F6F715C271C9A6A642CE987841B31F41CFB2522CAC23C3D69DC6B9D8F5ED237E756425BBE288ADF80F1BE6971A7A0CA3BE442461B17DA9DF975798B1642F1686DD962DDAF341C76697A98E403F812311AA0B146580E458C9301E7BE02E2D33511F2461591A6FD163F8E78AD80E79B58B9D5F7CBBE386DE0F7E610A305777FB35BD1B6C4F55CCD11A5E9F04C5558DA24A62BEDBE98A7EE3318201CA308201C6020101304F303B310B300906035504061302555331163014060355040A130D6D6963726F736F66742E636F6D311430120603550403130B53514C434C52204365727402106DFC260EB312E79845D7F0B3CC0E5088300906052B0E03021A0500A0523010060A2B06010401823702010C31023000301906092A864886F70D010903310C060A2B060104018237020104302306092A864886F70D010904311604146E44D767FCBD0FC763F8F729C2CA2067C3248ABB300D06092A864886F70D010101050004820100B44B082A2B71353A86CBF13444041B746F863BF0ADD52985EB05D71AAA6C60EFC94F770CB2C76A2967CE28F658483FC0B78234AE69C88F7DEDC23A44A6245BA2F193AFFA93271D8A5F34224824107F2C11E1A1806CE568E2CE1D0105F201DB21A83FD425E7F4C8BBB08B3B138B83736B94459423910AA32DED35CC239D69E03C46D6DC7E298440083246A72F660C0D0C6D0594D588C218568F52C3665F64756A99DDDD326C3C5AD464D511F4752CDC89F1A12EECC1D5E475AD55972EADE0754C9FA34FC1BDA850E8093334810C77F7A999ACC0A8274708FCEB7BF0054143A49B5D3C4658176EA7495D9AA28913A68DDBC52C210DB6774B2437F8930F7A8ECD8A000000
WITH PERMISSION_SET = UNSAFE
GO
DROP ASSEMBLY SendSBMsgUDF
GO
CREATE ASSEMBLY [SendSBMsgUDF]
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300F497E3970000000000000000E00022200B013000001600000008000000000000E63500000020000000400000000000100020000000020000040000000000000006000000000000000080000000020000BF4A0000030060850000100000100000000010000010000000000000100000000000000000000000913500004F000000004000002C040000000000000000000000200000C0050000006000000C000000B8340000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000EC150000002000000016000000020000000000000000000000000000200000602E727372630000002C040000004000000006000000180000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001E00000000000000000000000000004000004200000000000000000000000000000000C5350000000000004800000002000500482300007011000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300400F20000000100001100281000000A0A0028020000060B731100000A0C086F1200000A1F18076F1300000A00086F1200000A1F0C72010000706F1300000A00281400000A0F00FE16130000016F1500000A6F1600000A0D08725D00007072D7000070096F1700000A26081204280300000613051105202C010000FE04130611062C3472E1000070281000000A1307120706281800000A13081208281900000A13091209281A00000A281B00000A281C00000A130ADE421205281D00000A72FF0000701104281E00000A281C00000A130ADE26130B00110B2804000006281C00000A130ADE13130C00110C6F1F00000A281C00000A130ADE00110A2A0000011C000000000700C2C900131700000100000700C2DC00131800000113300800CA0000000200001100120020B2070000171716161616282000000A281000000A13061206282100000A06282200000A0B1201282300000A282400000A20B0040000580C7205010070282500000A72450100701202282600000A281E00000A0D281400000A72490100706F1600000A732700000A13041104281400000A096F1600000A6F2800000A282900000A1305282A00000A72A30100701A8D1000000125167205010070282500000AA225171105282500000AA22518088C27000001A22519720B020070A2282B00000A13072B0011072A000013300300540000000300001100026F2C00000A723F0200701F246F2D00000A0A0614282E00000A0B072C2A0006026F2F00000A751B0000010C0814FE030D092C130003086F3000000A51086F3100000A13042B09000314511613042B0011042A1B3004007C0000000400001100026F1F00000A0A00026F3200000A741B0000010B076F3300000A0C733400000A0D08096F3500000A00096F3600000A1304281400000A11046F3700000A725B020070076F3100000A13051205FE161E0000016F1500000A727F020070283800000A0A00DE0E13060011066F1F00000A0A00DE000613072B0011072A01100000000008005E66000E180000012202283900000A002A00000042534A4201000100000000000C00000076342E302E33303331390000000005006C00000018040000237E000084040000E005000023537472696E677300000000640A00008402000023555300E80C0000100000002347554944000000F80C00007804000023426C6F620000000000000002000001571D02000900000000FA013300160000010000002D0000000200000004000000050000000400000039000000040000000F00000004000000010000000300000000000D0301000000000006001E02C60406008B02C60406003D016D040F00E60400000600650194030600010294030600CD01940306007202940306003E02940306005702940306007C01940306005101A70406002F01A7040600B001940306009701BB020600430546030A00EC014C040A0072004C040A00E402F5040600DC0046030E0061054A0506005B0346030E00BA034A050600D303460306000A00A90506000C0494030E001F014A05060036033F00060030033F000E009A004A050E00A6034A050E002A044A050600B2027A050600CD0046030600FA0246030600040046030600720546030E00D4054A0506000300460306004D03A90506001604700306003C0446030600F80046030600130594030E0023014A05000000001E000000000001000100010010002700000041000100010051803B006B02518081006B025180D4006B0251809E056B0250200000000096002E006E0201006C210000000091006403750202004422000000009100A90079020200A422000000009100C703810204003C23000000008618670406000500000001009605000001006B0502000200F303000001002204090067040100110067040600190067040A00290067041000310067041000390067041000410067041000490067041000510067041000590067041000610067041500690067041000710067041000790067041000890067040600A10086053200A90067040600A90020053700F9003D033C000901150044008100EE024A0009010A054E00A90055005400A1003A055D00B100910464001101EE024A0019012C056800990055056E002101EE024A0019012C057400C100C1004A00A10067048A00A100E5009500A10085039A00B1008004640029010100A3003101B700A8003901EE024A00C9006704AD0041010103B3002901D502BA004901FD00C00019013305C6008100F500DA0059016900E000D100C605E900D100A902F100D900DD034A00D9008B00F600B90012010C0169011E031201E90067040600E10005041701E9008E051D010901F702220119012C0528018100670406000E00040039010E000800A0010E000C00DF010E001000120220007B00BE032E000B0087022E00130090022E001B00AF022E002300B8022E002B00CA022E00330005032E003B0005032E004300B8022E004B000B032E00530005032E005B0005032E00630039032E006B0063032E00730070031A007B00D000FB000480000001000000000000000000000000002E0000000400000000000000000000003001600000000000040000000000000000000000300149000000000004000000000000000000000030014603000000000000000000546F55496E74333200484D4143534841323536006765745F55544638003C4D6F64756C653E00434C525544460053656E6453424D7367554446005552490053797374656D2E494F0053797374656D2E446174610055706C6F616444617461006D73636F726C6962004765744669656C6400446174614163636573734B696E64004E616D657370616365006765745F537461747573436F64650048747470537461747573436F646500476574537461747573436F64650055726C456E636F6465006765745F4D65737361676500446F75626C65004B65794E616D65004461746554696D6500546F556E6976657273616C54696D650047657454797065006765745F496E76617269616E7443756C74757265006765745F526573706F6E73650048747470576562526573706F6E736500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E4174747269627574650053716C46756E6374696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650047657456616C756500456E636F64696E670053797374656D2E52756E74696D652E56657273696F6E696E6700546F426173653634537472696E670053716C537472696E6700546F537472696E6700476574537472696E6700436F6D70757465486173680053656E6453424D73675544462E646C6C00476574526573706F6E736553747265616D004D656D6F727953747265616D007365745F4974656D0053797374656D0048617368416C676F726974686D0054696D655370616E00476574536173546F6B656E0053797374656D2E476C6F62616C697A6174696F6E006F705F5375627472616374696F6E0053797374656D2E5265666C656374696F6E00576562486561646572436F6C6C656374696F6E00576562457863657074696F6E004765744572726F7246726F6D457863657074696F6E006765745F5374617475734465736372697074696F6E007374617475734465736372697074696F6E00436F7079546F004669656C64496E666F0043756C74757265496E666F00776562457863700048747470526571756573744865616465720049466F726D617450726F7669646572004D6963726F736F66742E53716C5365727665722E536572766572002E63746F720053797374656D2E446961676E6F7374696373006765745F546F74616C5365636F6E6473006765745F546F74616C4D696C6C697365636F6E64730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730053797374656D2E446174612E53716C54797065730047657442797465730042696E64696E67466C616773006765745F4865616465727300436F6E63617400466F726D6174005375627472616374004F626A6563740053797374656D2E4E6574006F705F496D706C6963697400576562436C69656E7400636C69656E7400436F6E766572740053797374656D2E54657874006765745F4E6F7700546F4172726179006D7367626F6479004163636F756E744B65790053797374656D2E53656375726974792E43727970746F677261706879006F705F496E657175616C697479005765625574696C6974790000005B6100700070006C00690063006100740069006F006E002F00610074006F006D002B0078006D006C003B0074007900700065003D0065006E007400720079003B0063006800610072007300650074003D007500740066002D0038000179680074007400700073003A002F002F006D00760068007300620070006F0063002E0073006500720076006900630065006200750073002E00770069006E0064006F00770073002E006E00650074002F007400610062006C0065006300680061006E00670065002F006D006500730073006100670065007300000950004F0053005400001D45006C00610070007300650064002000740069006D0065003A00200000053A002000003F6D00760068007300620070006F0063002E0073006500720076006900630065006200750073002E00770069006E0064006F00770073002E006E006500740000030A00005970006A0055006C00750037006F0034006B00740053002F004C004A004E0043007A004A00390061007A004A0054006B0037006E003900500056002B00420045004A00450034006D007800530030007A0043006F0063003D0000675300680061007200650064004100630063006500730073005300690067006E00610074007500720065002000730072003D007B0030007D0026007300690067003D007B0031007D002600730065003D007B0032007D00260073006B006E003D007B0033007D00003352006F006F0074004D0061006E006100670065005300680061007200650064004100630063006500730073004B0065007900001B6D005F0057006500620052006500730070006F006E0073006500002320002800480074007400700053007400610074007500730043006F00640065002000000329000000B7AF652BFA2E854AB56B7B88CD8B267200042001010803200001052001011111042001010E042001010217070D11510E12551D050E0802115111590D114D125D12610400001151042000127D072002011180810E0500001280850320000E0520011D050E0820031D050E0E1D05062001115911510320000D0500020E0E0E050001114D0E0600030E0E0E0E0E070811511159090E12650E11510E0A200701080808080808080420001151080002115911511151040001090D0400010E0E052001011D050620011D051D050500010E1D050500001280A50900030E1280A90E1D1C090705126902126D02080520001280AD08200212690E1180B107000202126912690420011C1C04200011791007080E126D127112751D05117912610E0520001280B504200012710520010112710420001D050520010E1D050700040E0E0E0E0E08B77A5C561934E08966680074007400700073003A002F002F006D00760068007300620070006F0063002E0073006500720076006900630065006200750073002E00770069006E0064006F00770073002E006E00650074002F007400610062006C0065006300680061006E00670065003E6D00760068007300620070006F0063002E0073006500720076006900630065006200750073002E00770069006E0064006F00770073002E006E00650074003252006F006F0074004D0061006E006100670065005300680061007200650064004100630063006500730073004B00650079005870006A0055006C00750037006F0034006B00740053002F004C004A004E0043007A004A00390061007A004A0054006B0037006E003900500056002B00420045004A00450034006D007800530030007A0043006F0063003D0002060E060001114D114D0300000E070002081255100E0500010E125D0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000001101000C53656E6453424D736755444600003A010035504F43206F6620434C522055444620746F2073656E642061206D65737361676520746F20417A75726520536572766963652042757300000501000000002D010028436F7079726967687420C2A9202032303139204D6963726F736F667420436F72706F726174696F6E00002901002431386665333834642D306565652D343338642D613334632D37393661663831633539333900000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E3280B601000300540E044E616D650C53656E6453424D73675544465455794D6963726F736F66742E53716C5365727665722E5365727665722E446174614163636573734B696E642C2053797374656D2E446174612C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038390A446174614163636573730000000054020F497344657465726D696E69737469630000000000000033DF369D0000000002000000A1000000F0340000F01600000000000000000000000000001000000000000000000000000000000052534453066382C311C09A4CA3C2D2A414EB08C201000000433A5C55736572735C6D6976616E6875755C736F757263655C7265706F735C444D4A476974536F75726365436F6E74726F6C5C507269766174655C495020616E6420536372697074735C546F6F6C735C53514C53657276696365427573504F435C53656E6453424D73675544465C6F626A5C44656275675C53656E6453424D73675544462E70646200B93500000000000000000000D3350000002000000000000000000000000000000000000000000000C5350000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000000000FF2500200010000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058400000D00300000000000000000000D00334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B00430030000010053007400720069006E006700460069006C00650049006E0066006F0000000C030000010030003000300030003000340062003000000084003600010043006F006D006D0065006E0074007300000050004F00430020006F006600200043004C0052002000550044004600200074006F002000730065006E0064002000610020006D00650073007300610067006500200074006F00200041007A00750072006500200053006500720076006900630065002000420075007300000022000100010043006F006D00700061006E0079004E0061006D006500000000000000000042000D000100460069006C0065004400650073006300720069007000740069006F006E0000000000530065006E006400530042004D007300670055004400460000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E003000000042001100010049006E007400650072006E0061006C004E0061006D0065000000530065006E006400530042004D00730067005500440046002E0064006C006C00000000007400280001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020002000320030003100390020004D006900630072006F0073006F0066007400200043006F00720070006F0072006100740069006F006E0000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000004A00110001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000530065006E006400530042004D00730067005500440046002E0064006C006C00000000003A000D000100500072006F0064007500630074004E0061006D00650000000000530065006E006400530042004D007300670055004400460000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000C000000E83500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C005000000020200308205B106092A864886F70D010702A08205A23082059E020101310B300906052B0E03021A0500304C060A2B060104018237020104A03E303C3017060A2B06010401823702010F3009030100A004A20280003021300906052B0E03021A05000414F6B54A3E6A4D0C59CFD69D268DE130640D74238AA082036E3082036A30820256A00302010202106DFC260EB312E79845D7F0B3CC0E5088300906052B0E03021D0500303B310B300906035504061302555331163014060355040A130D6D6963726F736F66742E636F6D311430120603550403130B53514C434C5220436572743020170D3139303930343230333432385A180F32303939313233313034303030305A303B310B300906035504061302555331163014060355040A130D6D6963726F736F66742E636F6D311430120603550403130B53514C434C52204365727430820122300D06092A864886F70D01010105000382010F003082010A0282010100BFA0F1A347A83B886B753FA158B65426B1DEECB2C46A9660135BDA45F56F8714800C515BE1609962B57A575E5A4339683CE1665C0E2E3812F6F6958EF96FE97893BD778D4230516005FE682CF5C263E6638A45B21F8F15CC07927B7937796E56591B1D706DF6726D84C646027C5FF28D2B567627A72E0DA6DDF41808D0DF9281E47E9C8AE007CF4DBAD4E349179A1C9FC3E9DD62EC9C448E9CFD3AA9E2DAE3DB9E86A028CFA1C24885C7DFA45FA9C8B35A98ED2EF31A3F5DDD30E03B6E64B1F135BAFA1FAB08199DD5DFAE0F894544100B91AECB117101DAA49E526A309B6915DD822C0285B24F3CFA2BF89088984E21B6674C2B1692B395985C0B51D9EF07D90203010001A370306E306C0603551D01046530638010F4A197D3F4E3ECF1D4E1E0417E935184A13D303B310B300906035504061302555331163014060355040A130D6D6963726F736F66742E636F6D311430120603550403130B53514C434C52204365727482106DFC260EB312E79845D7F0B3CC0E5088300906052B0E03021D05000382010100853E32A6278392ECF28EABD5EB9F2297D3282949818DD9CF4E175AB32D9588B2B144A920D630788E10CBF66DF0A135E43FCD36892F1E779D6D9EEA3CDC417C480D9A95257313C79678235019A419DF1F61E085D5B23CADDEDA108B16DF4C6C31658D56816A85424D90F6F715C271C9A6A642CE987841B31F41CFB2522CAC23C3D69DC6B9D8F5ED237E756425BBE288ADF80F1BE6971A7A0CA3BE442461B17DA9DF975798B1642F1686DD962DDAF341C76697A98E403F812311AA0B146580E458C9301E7BE02E2D33511F2461591A6FD163F8E78AD80E79B58B9D5F7CBBE386DE0F7E610A305777FB35BD1B6C4F55CCD11A5E9F04C5558DA24A62BEDBE98A7EE3318201CA308201C6020101304F303B310B300906035504061302555331163014060355040A130D6D6963726F736F66742E636F6D311430120603550403130B53514C434C52204365727402106DFC260EB312E79845D7F0B3CC0E5088300906052B0E03021A0500A0523010060A2B06010401823702010C31023000301906092A864886F70D010903310C060A2B060104018237020104302306092A864886F70D010904311604140372231A9DFC582617A3B13225BDB3D1934A9432300D06092A864886F70D01010105000482010022D6019153C67E95850937BBDF44E030123F2F78422DB9E1AD8C22C1431620C3BCAFC1015EA4096BF9E6808D905721E35F89064D970AFBDD021ACD46DA18BFD76904E454BC2A6CE365885CEB781AA35A68F0E98BBC78A70919F032BE07EBCD779560FE886F96A4C81C98520290976B5CD2844C937779BD55246D942BEF57A07E3F3B81C1895D4E602A9660B4CF45976C5A6D898E93E29C0DAAFB66355BCC13D6FE9CC380D1FA91421DDDFFAECF8ACE007A7A037223C93D7820BF00A73256399CBA0377C85C80D3E99734388794C13DCEDD97B7415668D68AD59E6DADD562AFF3E49BB66683E3ECC2FB131A344D144E4394F64E105E19BA6B530B68D0309ACD50000000
WITH PERMISSION_SET = UNSAFE
GO
CREATE TRIGGER testclr_SO
ON Sales.Orders 
FOR INSERT, UPDATE, DELETE  
AS  
EXTERNAL NAME SendSBMsg.CLRTriggers.trgSendSBMsg;  
go
update Sales.Orders set Comments='Service Bus to Activation Proc to Service Broker to CLR UDF - update in MI', PerfTest=sysdatetime() where OrderID between 1 and 100
go
update Sales.Orders set Comments='Service Bus to Activation Proc to CLR UDF - update in MI', PerfTest=sysdatetime() where OrderID between 11 and 1011
go
update Sales.Orders set Comments='Service Bus to Activation Proc to CLR UDF - update in MI', PerfTest=sysdatetime() where OrderID between 21 and 30
go
update Sales.Orders set Comments='Service Bus to Activation Proc to CLR UDF - update in MI', PerfTest=sysdatetime() where OrderID between 31 and 40
go
update Sales.Orders set Comments='Service Bus to Activation Proc to CLR UDF - update in MI', PerfTest=sysdatetime() where OrderID between 41 and 50
go
update Sales.Orders set Comments='Service Bus to Activation Proc to CLR UDF - update in MI', PerfTest=sysdatetime() where OrderID between 51 and 60
go
update Sales.Orders set Comments='Service Bus to Activation Proc to CLR UDF - update in MI', PerfTest=sysdatetime() where OrderID between 61 and 70
go
update Sales.Orders set Comments='Service Bus to Activation Proc to CLR UDF - update in MI', PerfTest=sysdatetime() where OrderID between 71 and 80
go
update Sales.Orders set Comments='Service Bus to Activation Proc to CLR UDF - update in MI', PerfTest=sysdatetime() where OrderID between 81 and 90
go
update Sales.Orders set Comments='Service Bus to Activation Proc to CLR UDF - update in MI', PerfTest=sysdatetime() where OrderID between 91 and 100
go


DROP Function SendSBMsg
go
CREATE FUNCTION SendSBMsg(@msgbody nvarchar(max))
RETURNS nvarchar(max)
AS  
EXTERNAL NAME SendSBMsgUDF.CLRUDF.SendSBMsgUDF;  
go

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- DIRECT SEND TO SERVICE BUS TRIGGER
drop trigger sales.trgsenddirect_SO
go
create trigger trgsenddirect_SO on Sales.Orders
for insert, update, delete
as
declare @inserted int
select @inserted=count(*) from inserted
declare @msgbody nvarchar(max)
if (@inserted > 0)
 begin
	set @msgbody = (select * from inserted for xml path)
	select @msgbody = '<message><server>' + REPLACE(@@SERVERNAME, '\', '%5C') + '</server><action>insert</action><table>Sales.Orders</table><rows>' + @msgbody + '</rows></message>'
 end
else
 begin
	set @msgbody = (select * from deleted for xml path)
	select @msgbody = '<message><server>' + REPLACE(@@SERVERNAME, '\', '%5C') + '</server><action>delete</action><table>Sales.Orders</table><rows>' + @msgbody + '</rows></message>'
 end
select dbo.SendSBMsg(@msgbody)
go
